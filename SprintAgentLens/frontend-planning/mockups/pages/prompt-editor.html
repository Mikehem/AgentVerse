<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprint Agent Lens - Prompt Editor</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Base CSS Framework -->
    <link rel="stylesheet" href="../assets/base.css">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <style>
        .editor-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 1.5rem;
            height: calc(100vh - 180px);
        }
        
        .editor-main {
            display: flex;
            flex-direction: column;
        }
        
        .editor-textarea {
            flex: 1;
            min-height: 400px;
            font-family: var(--font-family-mono);
            font-size: 14px;
            line-height: 1.5;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: 1rem;
            resize: none;
            background-color: var(--color-background-card);
        }
        
        .editor-textarea:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 2px var(--color-primary-alpha);
        }
        
        .version-history {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .version-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            border: 1px solid var(--color-border-light);
            border-radius: var(--radius-base);
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .version-item:hover {
            border-color: var(--color-primary);
            background-color: var(--color-primary-alpha);
        }
        
        .version-item.current {
            border-color: var(--color-primary);
            background-color: var(--color-primary-alpha);
        }
        
        .variable-chip {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.5rem;
            background-color: var(--color-accent-alpha);
            border: 1px solid var(--color-accent);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--color-accent-dark);
            margin: 0.125rem;
            cursor: pointer;
        }
        
        .variable-chip:hover {
            background-color: var(--color-accent);
            color: var(--color-text-inverse);
        }
        
        .test-input {
            background-color: var(--color-background);
            border: 1px solid var(--color-border-light);
            border-radius: var(--radius-base);
            padding: 0.75rem;
            margin-bottom: 0.75rem;
        }
        
        .test-output {
            background-color: var(--color-background-card);
            border: 1px solid var(--color-border-light);
            border-radius: var(--radius-base);
            padding: 1rem;
            font-family: var(--font-family-mono);
            font-size: 0.875rem;
            line-height: 1.5;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .toolbar {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            border: 1px solid var(--color-border-light);
            border-bottom: none;
            border-top-left-radius: var(--radius-md);
            border-top-right-radius: var(--radius-md);
            background-color: var(--color-background);
        }
        
        .toolbar-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            background-color: var(--color-background-card);
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .toolbar-btn:hover {
            border-color: var(--color-primary);
            background-color: var(--color-primary-alpha);
        }
        
        .sidebar-section {
            margin-bottom: 1.5rem;
        }
        
        .sidebar-section h3 {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .collapsible-content {
            transition: max-height 0.3s ease;
            overflow: hidden;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin-top: 0.75rem;
        }
        
        .metric-card {
            text-align: center;
            padding: 0.75rem;
            background-color: var(--color-background);
            border: 1px solid var(--color-border-light);
            border-radius: var(--radius-base);
        }
        
        .metric-value {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--color-primary);
        }
        
        .metric-label {
            font-size: 0.75rem;
            color: var(--color-text-muted);
            margin-top: 0.25rem;
        }
        
        .char-counter {
            font-size: 0.75rem;
            color: var(--color-text-muted);
            text-align: right;
            margin-top: 0.5rem;
        }
        
        .tags-input {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
            align-items: center;
            min-height: 38px;
            padding: 0.5rem;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            background-color: var(--color-background-card);
        }
        
        .tag-item {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            background-color: var(--color-primary-alpha);
            color: var(--color-primary);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
        }
        
        .tag-remove {
            cursor: pointer;
            opacity: 0.7;
        }
        
        .tag-remove:hover {
            opacity: 1;
        }
        
        .tag-input {
            border: none;
            outline: none;
            background: transparent;
            flex: 1;
            min-width: 100px;
            font-size: 0.875rem;
        }
    </style>
</head>
<body class="bg-background">
    <!-- Main Layout Container -->
    <div class="min-h-screen flex">
        <!-- Sidebar Navigation -->
        <nav class="sidebar w-64 bg-card border-r border-light flex flex-col">
            <!-- Logo Section -->
            <div class="p-6 border-b border-light">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-primary rounded-md flex items-center justify-center">
                        <i data-lucide="zap" class="w-5 h-5 text-inverse"></i>
                    </div>
                    <span class="font-semibold text-lg text-primary">Sprint Agent Lens</span>
                </div>
            </div>
            
            <!-- Navigation Menu -->
            <div class="flex-1 p-4">
                <ul class="space-y-1">
                    <li>
                        <a href="main-dashboard.html" class="nav-item flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium text-secondary hover:bg-accent-alpha hover:text-primary transition-colors">
                            <i data-lucide="layout-dashboard" class="w-4 h-4"></i>
                            Dashboard
                        </a>
                    </li>
                    <li>
                        <a href="individual-project-view.html" class="nav-item flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium text-secondary hover:bg-accent-alpha hover:text-primary transition-colors">
                            <i data-lucide="folder" class="w-4 h-4"></i>
                            Projects
                        </a>
                    </li>
                    <li>
                        <a href="agent-monitoring.html" class="nav-item flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium text-secondary hover:bg-accent-alpha hover:text-primary transition-colors">
                            <i data-lucide="bot" class="w-4 h-4"></i>
                            Agents
                        </a>
                    </li>
                    <li>
                        <a href="prompt-library.html" class="nav-item active flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium bg-primary-alpha text-primary">
                            <i data-lucide="message-square" class="w-4 h-4"></i>
                            Prompts
                        </a>
                    </li>
                    <li>
                        <a href="test-suite.html" class="nav-item flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium text-secondary hover:bg-accent-alpha hover:text-primary transition-colors">
                            <i data-lucide="flask" class="w-4 h-4"></i>
                            Testing
                        </a>
                    </li>
                    <li>
                        <a href="dataset-dashboard.html" class="nav-item flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium text-secondary hover:bg-accent-alpha hover:text-primary transition-colors">
                            <i data-lucide="database" class="w-4 h-4"></i>
                            Datasets
                        </a>
                    </li>
                </ul>
                
                <!-- Secondary Navigation -->
                <div class="mt-8 pt-6 border-t border-light">
                    <p class="px-3 text-xs font-semibold text-muted uppercase tracking-wider mb-3">
                        Administration
                    </p>
                    <ul class="space-y-1">
                        <li>
                            <a href="user-management-admin.html" class="nav-item flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium text-secondary hover:bg-accent-alpha hover:text-primary transition-colors">
                                <i data-lucide="users" class="w-4 h-4"></i>
                                User Management
                            </a>
                        </li>
                        <li>
                            <a href="llm-provider-management.html" class="nav-item flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium text-secondary hover:bg-accent-alpha hover:text-primary transition-colors">
                                <i data-lucide="cpu" class="w-4 h-4"></i>
                                LLM Providers
                            </a>
                        </li>
                        <li>
                            <a href="admin-dashboard.html" class="nav-item flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium text-secondary hover:bg-accent-alpha hover:text-primary transition-colors">
                                <i data-lucide="bar-chart" class="w-4 h-4"></i>
                                Analytics
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            
            <!-- User Profile Section -->
            <div class="p-4 border-t border-light">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center">
                        <span class="text-sm font-medium text-primary">JD</span>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-medium text-primary truncate">John Doe</p>
                        <p class="text-xs text-muted truncate">john@company.com</p>
                    </div>
                    <button class="p-1 rounded-md hover:bg-accent-alpha transition-colors">
                        <i data-lucide="more-horizontal" class="w-4 h-4 text-muted"></i>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <div class="flex-1 flex flex-col">
            <!-- Top Header -->
            <header class="bg-card border-b border-light px-6 py-4">
                <div class="flex items-center justify-between">
                    <!-- Page Title and Breadcrumb -->
                    <div>
                        <h1 class="text-2xl font-semibold text-primary">Prompt Editor</h1>
                        <nav class="flex items-center gap-2 mt-1" aria-label="Breadcrumb">
                            <span class="text-sm text-muted">Dashboard</span>
                            <i data-lucide="chevron-right" class="w-4 h-4 text-muted"></i>
                            <span class="text-sm text-muted">Prompts</span>
                            <i data-lucide="chevron-right" class="w-4 h-4 text-muted"></i>
                            <span class="text-sm text-primary">Customer Support Assistant</span>
                        </nav>
                    </div>
                    
                    <!-- Header Actions -->
                    <div class="flex items-center gap-3">
                        <button class="btn btn-outline">
                            <i data-lucide="play" class="w-4 h-4"></i>
                            Test Prompt
                        </button>
                        <button class="btn btn-outline">
                            <i data-lucide="save" class="w-4 h-4"></i>
                            Save Draft
                        </button>
                        <button class="btn btn-primary">
                            <i data-lucide="check" class="w-4 h-4"></i>
                            Publish
                        </button>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <main class="flex-1 p-6 overflow-hidden">
                <div class="editor-layout">
                    <!-- Main Editor -->
                    <div class="editor-main">
                        <!-- Prompt Metadata -->
                        <div class="card mb-6">
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-secondary mb-2">Prompt Name</label>
                                    <input type="text" value="Customer Support Assistant" class="input">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-secondary mb-2">Category</label>
                                    <select class="input">
                                        <option>Customer Support</option>
                                        <option>Content Generation</option>
                                        <option>Data Analysis</option>
                                        <option>Code Review</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-secondary mb-2">Description</label>
                                <textarea class="input" rows="2" placeholder="Describe what this prompt does and when to use it...">Help customers with common inquiries and escalation routing. Provides structured responses and knows when to escalate complex issues.</textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-secondary mb-2">Tags</label>
                                <div class="tags-input">
                                    <div class="tag-item">
                                        customer-support
                                        <span class="tag-remove">×</span>
                                    </div>
                                    <div class="tag-item">
                                        chatbot
                                        <span class="tag-remove">×</span>
                                    </div>
                                    <div class="tag-item">
                                        escalation
                                        <span class="tag-remove">×</span>
                                    </div>
                                    <input type="text" class="tag-input" placeholder="Add tag...">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Prompt Editor -->
                        <div class="card flex-1" style="display: flex; flex-direction: column;">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="font-semibold text-primary">Prompt Content</h3>
                                <div class="flex items-center gap-2">
                                    <span class="text-sm text-muted">Version:</span>
                                    <select class="input text-sm py-1 px-2 w-auto">
                                        <option>v2.1 (Current)</option>
                                        <option>v2.0</option>
                                        <option>v1.9</option>
                                        <option>v1.8</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Editor Toolbar -->
                            <div class="toolbar">
                                <div class="toolbar-btn" title="Bold">
                                    <i data-lucide="bold" class="w-4 h-4"></i>
                                </div>
                                <div class="toolbar-btn" title="Italic">
                                    <i data-lucide="italic" class="w-4 h-4"></i>
                                </div>
                                <div class="toolbar-btn" title="Underline">
                                    <i data-lucide="underline" class="w-4 h-4"></i>
                                </div>
                                <div style="width: 1px; height: 20px; background-color: var(--color-border); margin: 0 0.5rem;"></div>
                                <div class="toolbar-btn" title="Insert Variable">
                                    <i data-lucide="braces" class="w-4 h-4"></i>
                                </div>
                                <div class="toolbar-btn" title="Insert Example">
                                    <i data-lucide="lightbulb" class="w-4 h-4"></i>
                                </div>
                                <div class="toolbar-btn" title="Format">
                                    <i data-lucide="align-left" class="w-4 h-4"></i>
                                </div>
                                <div style="width: 1px; height: 20px; background-color: var(--color-border); margin: 0 0.5rem;"></div>
                                <div class="toolbar-btn" title="Undo">
                                    <i data-lucide="undo" class="w-4 h-4"></i>
                                </div>
                                <div class="toolbar-btn" title="Redo">
                                    <i data-lucide="redo" class="w-4 h-4"></i>
                                </div>
                            </div>
                            
                            <textarea class="editor-textarea" placeholder="Enter your prompt here...">You are a helpful customer support assistant. Your role is to:

1. **Understand customer inquiries clearly**
   - Read the customer's message carefully
   - Identify the main issue or question
   - Note any specific details or context provided

2. **Provide accurate and helpful responses**
   - Use the knowledge base to find relevant information
   - Give step-by-step instructions when applicable
   - Be clear and concise in your explanations

3. **Escalate complex issues when needed**
   - If the issue requires technical expertise beyond your scope
   - If the customer is requesting a refund or account changes
   - If the customer is expressing significant frustration

4. **Maintain a friendly and professional tone**
   - Always be polite and empathetic
   - Acknowledge the customer's concerns
   - Use positive language even when delivering difficult news

**Response Format:**
- Start with a greeting and acknowledgment
- Address the main concern
- Provide clear next steps
- End by asking if they need further assistance

**Variables:**
- {customer_name}: The customer's name
- {issue_type}: The type of issue (billing, technical, account)
- {urgency}: Priority level (low, medium, high)

**Examples:**
Customer: "I can't log into my account"
Response: "I understand how frustrating it can be when you can't access your account, {customer_name}. Let me help you resolve this..."</textarea>
                            
                            <div class="char-counter">
                                1,247 characters • 189 words
                            </div>
                        </div>
                    </div>
                    
                    <!-- Right Sidebar -->
                    <div class="flex flex-col gap-6" style="overflow-y: auto;">
                        <!-- Variables Section -->
                        <div class="sidebar-section card">
                            <h3>
                                <i data-lucide="braces" class="w-4 h-4"></i>
                                Variables
                            </h3>
                            <div class="space-y-2">
                                <div class="flex justify-between items-center">
                                    <span class="variable-chip">{customer_name}</span>
                                    <button class="text-xs text-muted hover:text-primary">
                                        <i data-lucide="edit" class="w-3 h-3"></i>
                                    </button>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="variable-chip">{issue_type}</span>
                                    <button class="text-xs text-muted hover:text-primary">
                                        <i data-lucide="edit" class="w-3 h-3"></i>
                                    </button>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="variable-chip">{urgency}</span>
                                    <button class="text-xs text-muted hover:text-primary">
                                        <i data-lucide="edit" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                            <button class="btn btn-outline w-full mt-3" style="font-size: 0.875rem; padding: 0.5rem;">
                                <i data-lucide="plus" class="w-4 h-4"></i>
                                Add Variable
                            </button>
                        </div>
                        
                        <!-- Quick Test Section -->
                        <div class="sidebar-section card">
                            <h3>
                                <i data-lucide="play" class="w-4 h-4"></i>
                                Quick Test
                            </h3>
                            <div class="space-y-3">
                                <div class="test-input">
                                    <label class="text-xs text-muted mb-1 block">Customer Input</label>
                                    <textarea class="w-full border-none resize-none bg-transparent text-sm" rows="3" placeholder="Enter test customer message...">I can't log into my account and I need to access my orders for tomorrow's meeting.</textarea>
                                </div>
                                
                                <button class="btn btn-primary w-full text-sm">
                                    <i data-lucide="zap" class="w-4 h-4"></i>
                                    Test Response
                                </button>
                                
                                <div class="test-output">
                                    <div class="text-xs text-muted mb-2">Response (GPT-4):</div>
                                    <div class="text-sm">
                                        I understand how frustrating it can be when you can't access your account, especially with an important meeting tomorrow. Let me help you resolve this login issue quickly.

                                        Here are the steps to reset your access:

                                        1. Go to our login page and click "Forgot Password"
                                        2. Enter your email address
                                        3. Check your email for a reset link (including spam folder)
                                        4. Create a new password

                                        If you're still having trouble, I can send you a temporary access code to view your orders. Would you like me to do that?
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Performance Metrics -->
                        <div class="sidebar-section card">
                            <h3>
                                <i data-lucide="bar-chart" class="w-4 h-4"></i>
                                Performance
                            </h3>
                            <div class="metrics-grid">
                                <div class="metric-card">
                                    <div class="metric-value">94%</div>
                                    <div class="metric-label">Success Rate</div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-value">4.2s</div>
                                    <div class="metric-label">Avg Response</div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-value">1,247</div>
                                    <div class="metric-label">Total Uses</div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-value">4.8</div>
                                    <div class="metric-label">User Rating</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Version History -->
                        <div class="sidebar-section card">
                            <h3>
                                <i data-lucide="git-branch" class="w-4 h-4"></i>
                                Version History
                            </h3>
                            <div class="version-history">
                                <div class="version-item current">
                                    <div>
                                        <div class="text-sm font-medium text-primary">v2.1</div>
                                        <div class="text-xs text-muted">Current • 2 hours ago</div>
                                    </div>
                                    <i data-lucide="check" class="w-4 h-4 text-success"></i>
                                </div>
                                
                                <div class="version-item">
                                    <div>
                                        <div class="text-sm font-medium text-secondary">v2.0</div>
                                        <div class="text-xs text-muted">1 day ago</div>
                                    </div>
                                    <i data-lucide="git-commit" class="w-4 h-4 text-muted"></i>
                                </div>
                                
                                <div class="version-item">
                                    <div>
                                        <div class="text-sm font-medium text-secondary">v1.9</div>
                                        <div class="text-xs text-muted">3 days ago</div>
                                    </div>
                                    <i data-lucide="git-commit" class="w-4 h-4 text-muted"></i>
                                </div>
                                
                                <div class="version-item">
                                    <div>
                                        <div class="text-sm font-medium text-secondary">v1.8</div>
                                        <div class="text-xs text-muted">1 week ago</div>
                                    </div>
                                    <i data-lucide="git-commit" class="w-4 h-4 text-muted"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Initialize Lucide Icons -->
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
        
        // Add some basic interactivity
        document.addEventListener('DOMContentLoaded', function() {
            // Character counter
            const textarea = document.querySelector('.editor-textarea');
            const counter = document.querySelector('.char-counter');
            
            function updateCounter() {
                const text = textarea.value;
                const chars = text.length;
                const words = text.trim() ? text.trim().split(/\s+/).length : 0;
                counter.textContent = `${chars} characters • ${words} words`;
            }
            
            textarea.addEventListener('input', updateCounter);
            
            // Tags input functionality
            const tagInput = document.querySelector('.tag-input');
            const tagsContainer = document.querySelector('.tags-input');
            
            tagInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && this.value.trim()) {
                    e.preventDefault();
                    addTag(this.value.trim());
                    this.value = '';
                }
            });
            
            function addTag(text) {
                const tagElement = document.createElement('div');
                tagElement.className = 'tag-item';
                tagElement.innerHTML = `
                    ${text}
                    <span class="tag-remove">×</span>
                `;
                tagsContainer.insertBefore(tagElement, tagInput);
                
                // Add remove functionality
                tagElement.querySelector('.tag-remove').addEventListener('click', function() {
                    tagElement.remove();
                });
            }
            
            // Remove existing tags
            document.querySelectorAll('.tag-remove').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.parentElement.remove();
                });
            });
            
            // Variable chips click to insert
            document.querySelectorAll('.variable-chip').forEach(chip => {
                chip.addEventListener('click', function() {
                    const variable = this.textContent.trim();
                    const textarea = document.querySelector('.editor-textarea');
                    const cursorPos = textarea.selectionStart;
                    const textBefore = textarea.value.substring(0, cursorPos);
                    const textAfter = textarea.value.substring(cursorPos);
                    textarea.value = textBefore + variable + textAfter;
                    textarea.focus();
                    textarea.setSelectionRange(cursorPos + variable.length, cursorPos + variable.length);
                });
            });
            
            // Version history clicks
            document.querySelectorAll('.version-item').forEach(item => {
                item.addEventListener('click', function() {
                    if (!this.classList.contains('current')) {
                        document.querySelectorAll('.version-item').forEach(v => v.classList.remove('current'));
                        this.classList.add('current');
                        console.log('Load version:', this.querySelector('.text-sm').textContent);
                    }
                });
            });
            
            // Toolbar buttons
            document.querySelectorAll('.toolbar-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const icon = this.querySelector('i').getAttribute('data-lucide');
                    console.log('Toolbar action:', icon);
                });
            });
        });
    </script>
</body>
</html>